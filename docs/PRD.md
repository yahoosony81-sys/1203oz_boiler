ğŸš— TripCarShare PRD (ê²°ì œ ê¸°ëŠ¥ í¬í•¨ ìµœì‹  ë²„ì „)

ì œì£¼ ê³µí•­ ê¸°ë°˜ P2P ì°¨ëŸ‰ ê³µìœ  í”Œë«í¼ â€“ MVP + ê²°ì œ í†µí•© ë²„ì „

1. Overview
1.1 Problem Statement

ì œì£¼ë„ ì—¬í–‰ê°ì€ ì‹œì¦Œë§ˆë‹¤ ë ŒíŠ¸ì¹´ ë¶€ì¡± ë° ê°€ê²© í­ë“± ë¬¸ì œë¥¼ ê²ªëŠ”ë‹¤. ë°˜ë©´ ì œì£¼ë„ë¯¼ì˜ ì°¨ëŸ‰ì€ ê³µí•­ì— ì¥ê¸°ê°„ ì£¼ì°¨ë˜ë©° ìœ íœ´ ìƒíƒœë¡œ ë‚¨ëŠ”ë‹¤.
TripCarShareëŠ” â€œë„ì°© ì—¬í–‰ìê°€ ì¶œë°œ ì—¬í–‰ìì˜ ì°¨ëŸ‰ì„ ì´ìš©í•˜ëŠ”â€ ìƒˆë¡œìš´ P2P ì°¨ëŸ‰ ê³µìœ  ëª¨ë¸ì„ ì œì‹œí•œë‹¤.

1.2 Why Important

ë ŒíŠ¸ì¹´ ê³µê¸‰ ë¬¸ì œ í•´ê²°

ì£¼ì°¨ì¥ íšŒì „ìœ¨ ì¦ê°€

ì°¨ì£¼ì—ê²ŒëŠ” â€œì£¼ì°¨ë¹„ + ë¶€ê°€ ìˆ˜ìµâ€

ì´ìš©ìì—ê²ŒëŠ” â€œë” ì €ë ´í•œ ì°¨ëŸ‰ ì´ìš©â€

2. Goals
2.1 MVP Goals

ì°¨ëŸ‰ ë“±ë¡ â†’ ê²€ìƒ‰ â†’ ì˜ˆì•½ â†’ ê²°ì œê¹Œì§€ ê°€ëŠ¥í•œ end-to-end í”Œë¡œìš° ì™„ì„±

ì‹¤ì œ ìˆ˜ìš”/ê³µê¸‰ ê²€ì¦ ë° í–‰ë™ ë°ì´í„° í™•ë³´

2.2 Success Metrics

ì˜ˆì•½ ìš”ì²­ ëŒ€ë¹„ ê²°ì œ ì „í™˜ìœ¨

ìŠ¹ì¸ìœ¨ / ì·¨ì†Œìœ¨

30ì¼ ë‚´ ì°¨ëŸ‰ 30ëŒ€ ì´ìƒ ë“±ë¡

ê²°ì œ 10ê±´ ì´ìƒ ë°œìƒ

3. Users
Owner (ì°¨ì£¼)

ì°¨ëŸ‰ ë“±ë¡ ë° ì¼ì • ê´€ë¦¬

ì˜ˆì•½ ìŠ¹ì¸ ë˜ëŠ” ê±°ì ˆ

ì •ì‚° ë‚´ì—­ í™•ì¸ ê°€ëŠ¥

Renter (ì´ìš©ì)

ì°¨ëŸ‰ ê²€ìƒ‰ â†’ ìƒì„¸ ì •ë³´ í™•ì¸

ì˜ˆì•½ ì‹ ì²­ ë° ê²°ì œ ì§„í–‰

ê²°ì œ ë‚´ì—­ í™•ì¸

4. Requirements
4.1 Core Features (MVP)

ì•„ë˜ëŠ” "ê²°ì œ í¬í•¨ ë²„ì „" ê¸°ì¤€ í•µì‹¬ ê¸°ëŠ¥ ëª©ë¡ì…ë‹ˆë‹¤.

4.1.1 ì°¨ëŸ‰ ë“±ë¡ (Owner)

ì°¨ëŸ‰ ê¸°ë³¸ ì •ë³´ ì…ë ¥

ì£¼ì°¨ ìœ„ì¹˜ ë° ê³µí•­ ì„ íƒ

ì‚¬ìš© ê°€ëŠ¥ ë‚ ì§œ ë²”ìœ„ ì§€ì •

ì°¨ëŸ‰ ì´ë¯¸ì§€ ì—…ë¡œë“œ

ê°€ê²©(per day) ì„¤ì •

ì°¨ëŸ‰ í™œì„±/ë¹„í™œì„± ê´€ë¦¬

4.1.2 ì°¨ëŸ‰ ê²€ìƒ‰ ë° ìƒì„¸ ì¡°íšŒ (Renter)

ë‚ ì§œ/ê³µí•­ ê¸°ë°˜ ê²€ìƒ‰

ê°€ê²©/ì—°ì‹/ëª¨ë¸ í•„í„°

ìƒì„¸ ì •ë³´ ì¡°íšŒ

ì´ ê¸ˆì•¡ ìë™ ê³„ì‚°

ì˜ˆì•½í•˜ê¸° ë²„íŠ¼ â†’ ì˜ˆì•½ ì‹ ì²­

4.1.3 ì˜ˆì•½ ì‹œìŠ¤í…œ
ì˜ˆì•½ ìƒì„±(createBooking)

ì¼ì • ì¤‘ë³µ ì²´í¬

pending ìƒíƒœë¡œ ìƒì„±

ì°¨ì£¼ì—ê²Œ ì•Œë¦¼

ì˜ˆì•½ ìŠ¹ì¸/ê±°ì ˆ(approveBooking / rejectBooking)

ì°¨ì£¼ê°€ ìŠ¹ì¸ ì‹œ í•´ë‹¹ ê¸°ê°„ ë¸”ë¡ ì²˜ë¦¬

ìŠ¹ì¸ëœ ì˜ˆì•½ë§Œ ê²°ì œ ì§„í–‰ ê°€ëŠ¥

ê±°ì ˆ ì‹œ ì´ìš©ìì—ê²Œ ì•Œë¦¼

4.1.4 ê²°ì œ(Payment) â†’ Toss Payments ì—°ë™
í•µì‹¬ íë¦„:

ì´ìš©ìê°€ ì˜ˆì•½ ìŠ¹ì¸ ìƒíƒœ í™•ì¸

â€œê²°ì œí•˜ê¸°â€ ë²„íŠ¼ í™œì„±í™”

Toss Payments ê²°ì œì°½ í˜¸ì¶œ

ê²°ì œ ì„±ê³µ ì‹œ bookings.payment_status = paid

ê²°ì œ ì‹¤íŒ¨ ì‹œ bookings.payment_status = failed

ìš”êµ¬ ê¸°ëŠ¥ ìƒì„¸
1) Toss API ì‚¬ìš© ë°©ì‹

ê²°ì œ ì¤€ë¹„ API í˜¸ì¶œ(Server action)

ê²°ì œ ìŠ¹ì¸ Redirect URL ì²˜ë¦¬(Route handler)

ê²°ì œ ì„±ê³µ/ì‹¤íŒ¨ Webhook ì²˜ë¦¬

Supabaseì— ê²°ì œ ê¸°ë¡ ì €ì¥

2) ê²°ì œ ì‹œ ìƒì„±ë˜ëŠ” ë°ì´í„°

payment_id (toss paymentKey)

order_id (booking_id ê¸°ë°˜ ìƒì„±)

amount

status (paid, failed)

approved_at

3) ê²°ì œ UI

ì°¨ëŸ‰ ìƒì„¸ í˜ì´ì§€ â€œì˜ˆì•½ ìŠ¹ì¸ í›„â€ ìš°ì¸¡ ê²°ì œ ë°•ìŠ¤ ê³ ì •

Toss ê²°ì œ ë²„íŠ¼

ê²°ì œ ê¸ˆì•¡ í‘œì‹œ

ê²°ì œ ì§„í–‰ ì¤‘ ë¡œë”© ì²˜ë¦¬

4.2 Optional Features (v1.1 ì´í›„)

ì •ì‚° í˜ì´ì§€ (owner payout, ì€í–‰ ê³„ì¢Œ ë“±ë¡)

ì˜ìˆ˜ì¦ ì´ë©”ì¼ ë°œì†¡

SMS ì•Œë¦¼

ë³´í—˜ API ì—°ë™

5. Product Flow
5.1 ì‚¬ìš©ì ì „ì²´ íë¦„ (with ê²°ì œ)
flowchart TD

A[ì°¨ëŸ‰ ê²€ìƒ‰] --> B[ì°¨ëŸ‰ ì„ íƒ]
B --> C[ë‚ ì§œ ì„ íƒ ë° ì˜ˆì•½ ì‹ ì²­]
C --> D[ì°¨ì£¼ ìŠ¹ì¸ ëŒ€ê¸°]
D -->|ìŠ¹ì¸| E[ê²°ì œ ë²„íŠ¼ í™œì„±í™”]
E --> F[Toss Payments ê²°ì œì°½]
F -->|ì„±ê³µ| G[ê²°ì œ ì™„ë£Œ â†’ booking=paid]
F -->|ì‹¤íŒ¨| H[ê²°ì œ ì‹¤íŒ¨, ì¬ì‹œë„ ì•ˆë‚´]
G --> I[ì´ìš©ì ì˜ˆì•½ í™•ì¸ í˜ì´ì§€]
I --> J[ì°¨ëŸ‰ í”½ì—… ë° ì‚¬ìš©]

6. Pages & UI Requirements
6.1 ì°¨ëŸ‰ ìƒì„¸ í˜ì´ì§€ (/vehicles/[id])
êµ¬ì„±

ìƒë‹¨: ì´ë¯¸ì§€ ê°¤ëŸ¬ë¦¬ + ê¸°ë³¸ ì •ë³´

ì¤‘ë‹¨: ì„¤ëª…, ìœ„ì¹˜, ì´ìš© ê°€ëŠ¥ ë‚ ì§œ

ìš°ì¸¡ ê³ ì • ì„¹ì…˜:

ê°€ê²© / ì¼

ì´ ê¸ˆì•¡

ì˜ˆì•½ ì‹ ì²­ ë²„íŠ¼

ì˜ˆì•½ ìŠ¹ì¸ í›„ â†’ ê²°ì œ ë²„íŠ¼ ë“±ì¥

ì‹ ê·œ í¬í•¨ UI

"ê²°ì œí•˜ê¸°(Toss Payments)"

ê²°ì œ ì§„í–‰ ëª¨ë‹¬ ë˜ëŠ” ì™¸ë¶€ ê²°ì œì°½

6.2 ê²°ì œ ì™„ë£Œ í˜ì´ì§€ (/payments/success)

ê²°ì œ ê¸ˆì•¡

ì˜ˆì•½ ID

ì°¨ëŸ‰ ì •ë³´

ì‚¬ìš© ì•ˆë‚´ ë¬¸êµ¬

ì˜ˆì•½ í˜ì´ì§€ë¡œ ì´ë™ ë²„íŠ¼

6.3 ê²°ì œ ì‹¤íŒ¨ í˜ì´ì§€ (/payments/fail)

ì‹¤íŒ¨ ì‚¬ìœ 

ì¬ê²°ì œ ë²„íŠ¼

6.4 ë§ˆì´í˜ì´ì§€ (/my)

í†µí•© ì‚¬ìš©ì í”„ë¡œí•„ ë° ì£¼ë¬¸ ë‚´ì—­ ê´€ë¦¬ í˜ì´ì§€

êµ¬ì„±

ì‚¬ìš©ì í”„ë¡œí•„ ì„¹ì…˜

í”„ë¡œí•„ ì´ë¯¸ì§€ (Clerk)

ì´ë¦„, ì´ë©”ì¼, ì „í™”ë²ˆí˜¸

ì—­í•  ë°°ì§€ (owner/renter)

ë³¸ì¸ ì¸ì¦ ìƒíƒœ

í†µê³„ ì¹´ë“œ

ì´ ì£¼ë¬¸ ìˆ˜ (ê²°ì œ ì™„ë£Œëœ ì˜ˆì•½)

ì´ ê²°ì œ ê¸ˆì•¡

ì§„í–‰ ì¤‘ì¸ ì˜ˆì•½ ìˆ˜

ë“±ë¡í•œ ì°¨ëŸ‰ ìˆ˜ (ownerì¸ ê²½ìš°)

ì£¼ë¬¸ ë‚´ì—­ ì„¹ì…˜

í•„í„° (ì „ì²´/ê²°ì œ ì™„ë£Œ/ì§„í–‰ ì¤‘/ì·¨ì†Œë¨)

ì£¼ë¬¸ ì¹´ë“œ ëª©ë¡

ì£¼ë¬¸ ë²ˆí˜¸ (order_id)

ì£¼ë¬¸ì¼ì‹œ (created_at)

ì°¨ëŸ‰ ì •ë³´ (ì´ë¯¸ì§€, ì°¨ì¢…, ì—°ì‹)

ëŒ€ì—¬ ê¸°ê°„ (start_date ~ end_date)

ê²°ì œ ê¸ˆì•¡ (total_price)

ìƒíƒœ ë°°ì§€ (ì˜ˆì•½ ìƒíƒœ, ê²°ì œ ìƒíƒœ)

ì£¼ë¬¸ ìƒì„¸ ë³´ê¸° ë²„íŠ¼

ì£¼ë¬¸ ìƒì„¸ í˜ì´ì§€ (/my/orders/[id])

ê¸°ë³¸ ì •ë³´

ì£¼ë¬¸ ë²ˆí˜¸, ì£¼ë¬¸ì¼ì‹œ, ê²°ì œì¼ì‹œ

ì°¨ëŸ‰ ì •ë³´

ì´ë¯¸ì§€ ê°¤ëŸ¬ë¦¬

ì°¨ì¢…, ì—°ì‹, ë²ˆí˜¸íŒ

ê³µí•­ ìœ„ì¹˜, ì£¼ì°¨ ìœ„ì¹˜

ì˜ˆì•½ ì •ë³´

ëŒ€ì—¬ ì‹œì‘ì¼/ì‹œê°„, ì¢…ë£Œì¼/ì‹œê°„

í”½ì—… ìœ„ì¹˜, ë°˜ë‚© ìœ„ì¹˜

ì´ ëŒ€ì—¬ ì¼ìˆ˜

ê²°ì œ ì •ë³´

ê²°ì œ ê¸ˆì•¡

ê²°ì œ ìƒíƒœ

ê²°ì œ ìˆ˜ë‹¨ (Toss Payments)

ê²°ì œ ID, ì£¼ë¬¸ ID

ìƒíƒœ ì •ë³´

ì˜ˆì•½ ìƒíƒœ

ì•¡ì…˜ ë²„íŠ¼

ì°¨ëŸ‰ ìƒì„¸ ë³´ê¸°

ì°¨ì£¼ ì—°ë½í•˜ê¸°

ì˜ˆì•½ ì·¨ì†Œ (ì¡°ê±´ë¶€)

7. Database Schema (ê²°ì œ í•„ë“œ í¬í•¨)
7.1 bookings í…Œì´ë¸” ìˆ˜ì •
í•„ë“œëª…	íƒ€ì…	ì„¤ëª…
id	uuid	ê¸°ë³¸ PK
vehicle_id	uuid	ì°¨ëŸ‰ FK
renter_id	uuid	ì‚¬ìš©ì FK
start_date	date	ëŒ€ì—¬ ì‹œì‘
end_date	date	ëŒ€ì—¬ ì¢…ë£Œ
total_price	int	ì´ ê²°ì œ ê¸ˆì•¡
status	enum	pending / approved / rejected / completed / cancelled
payment_status	enum	unpaid / paid / failed
payment_id	text	toss paymentKey
order_id	text	toss orderId
created_at	timestamp	
updated_at	timestamp	
8. API / Server Action Requirements
8.1 createPaymentIntent (ê²°ì œ ì¤€ë¹„)

Toss API í˜¸ì¶œ

orderId ìƒì„± (booking-uuid)

amount ì „ë‹¬

returnUrl / failUrl í¬í•¨

8.2 approvePayment (ë¦¬ë””ë ‰ì…˜ ì²˜ë¦¬)

Toss ìŠ¹ì¸ API í˜¸ì¶œ

paymentKey ê²€ì¦

supabase bookings.payment_status ì—…ë°ì´íŠ¸

8.3 webhookSync (ì˜µì…˜)

Toss webhookìœ¼ë¡œ ê²°ì œ ìƒíƒœ ë³€ë™ ì¶”ì 

ê²°ì œ ì¤‘ë„ ì·¨ì†Œ / ì‹¤íŒ¨ ëŒ€ì‘

9. Technical Architecture
9.1 Frontend

Next.js 15 App Router

Server Actionsë¡œ ê²°ì œ ìƒì„±

ê²°ì œ ì„±ê³µ/ì‹¤íŒ¨ Redirect Route ì²˜ë¦¬

9.2 Backend

Supabase DB

Supabase Auth Ã— Clerk ID ì—°ë™

Toss Payments REST API

9.3 Storage

ì°¨ëŸ‰ ì´ë¯¸ì§€ Supabase Storage

10. Non-Functional Requirements
ì„±ëŠ¥

ê²°ì œ ìš”ì²­ 200ms ì´ë‚´ ì‘ë‹µ ëª©í‘œ

ë³´ì•ˆ

paymentKeyëŠ” server-only ì €ì¥

booking approval ì´í›„ë§Œ ê²°ì œ ê°€ëŠ¥

ì•ˆì •ì„±

Toss webhook ì¤‘ë³µ í˜¸ì¶œ ëŒ€ë¹„

DB íŠ¸ëœì­ì…˜ ì‚¬ìš©

11. Out of Scope (MVP)

OTA(ë Œí„°ì¹´ ìˆ˜ì¤€) ë³´í—˜ ì—°ë™

ì‹¤ì‹œê°„ ì°¨ëŸ‰ ìœ„ì¹˜ í™•ì¸(GPS)

ì •ì‚°/ì†¡ê¸ˆ ìë™í™”

ëª¨ë°”ì¼ ì•±

12. Risks

ì°¨ì£¼ì™€ ì´ìš©ì ê°„ í‚¤ ì „ë‹¬ ë¬¸ì œ

ì‚¬ê³  ë°œìƒ ì‹œ ì±…ì„ ë²”ìœ„

ê²°ì œ ì·¨ì†Œ/í™˜ë¶ˆ ì •ì±…

13. Future Enhancements

ì°¨ì£¼ ì •ì‚° ìë™í™”(Payouts)

ë³´í—˜ API ì—°ë™

ì°¨ëŸ‰ í‰ê°€/ë¦¬ë·° ê¸°ëŠ¥

ê³µí•­ í™•ì¥ (ê¹€í¬/ë¶€ì‚° ë“±)